{% extends 'College/Navigation.html' %}
{% block content %}
{% load static %}


<form method="post" action="/SaveStudent/" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="modal fade" id="Doctor" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header ">
                    <div class="container">
                        <h3 class="text-center" id="exampleModalLabel">Add Student</h3>
                    </div>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <input type="text" id="id" name="id" hidden>
                    <div class="row">
                        <div class="col-md mx-2">
                            <div class="form-group mx-2">
                                <label for="inputName"><b>Name</b></label>
                                <input type="text" class="form-control " id="name" name="name"
                                    placeholder="Student Name" required
                                    oninvalid="this.setCustomValidity('Provide Student Name')"
                                    oninput="setCustomValidity('')">
                            </div>

                            <div class="form-group mx-2">
                                <label for="inputPhone"><b>Phone Number</b></label>
                                <input type="tel" class="form-control" id="phone" pattern="[0-9]{10}" name="phone"
                                    placeholder="Phone Number" required
                                    oninvalid="this.setCustomValidity('Provide valid Phone Number')"
                                    oninput="setCustomValidity('')">
                            </div>
                            <div class="form-group mx-2">

                                <label for="inputaddress"><b>Age</b></label>
                                <input type="number" class="form-control " id="age" name="age" placeholder="Age"
                                    required oninvalid="this.setCustomValidity('Provide Player Age')"
                                    oninput="setCustomValidity('')">


                            </div>
                            <div class="form-group mx-2">
                                <label for="inputaddress"><b>Gender</b></label>
                                <select class="form-control" id="gender" name="gender" required
                                    oninvalid="this.setCustomValidity('Select Student gender')"
                                    oninput="setCustomValidity('')">
                                    <option value="">--Select--</option>
                                    <option value="Male">Male </option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>


                                </select>
                            </div>
                            <div class="form-group mx-2">
                                <label for="inputName"><b>Year</b></label>
                                <input type="year" class="form-control " id="year" name="year" placeholder="Year"
                                    required oninvalid="this.setCustomValidity('Provide Student Academic year')"
                                    oninput="setCustomValidity('')">
                            </div>

                            <div class="form-group mx-2">

                                <label for="inputaddress"><b>Address</b></label>
                                <textarea class="form-control" id="address" name="address" placeholder="Address"
                                    rows="3" required oninvalid="this.setCustomValidity('Provide Student Address')"
                                    oninput="setCustomValidity('')"></textarea>

                                <br>


                            </div>
                        </div>
                        <div class="col-md mx-2">
                            <div class="form-group mx-2">
                                <label for="inputName"><b>USN</b> (must be 10 char)</label>
                                <input type="text" class="form-control " id="username" name="username"
                                    placeholder="USN" required
                                    oninvalid="this.setCustomValidity('Provide Valid Student USN')"
                                    oninput="setCustomValidity('')" maxlength="10" pattern=".{10}">
                            </div>
                            <div class="form-group mx-2">
                                <label for="inputemail"><b>Email</b></label>
                                <input type="email" class="form-control" id="email"
                                    pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" name="email" placeholder="Email"
                                    required oninvalid="this.setCustomValidity('Provide valid Email')"
                                    oninput="setCustomValidity('')">

                            </div>

                            <div class="form-group mx-2">
                                <label for="inputName"><b>Father Name</b></label>
                                <input type="text" class="form-control " id="fathername" name="fathername"
                                    placeholder="Father Name" required
                                    oninvalid="this.setCustomValidity('Provide Student Father Name')"
                                    oninput="setCustomValidity('')">
                            </div>
                            <div class="form-group mx-2">
                                <label for="inputaddress"><b>Branch</b></label>

                                <select class="form-control" id="branch" name="branch" required
                                    oninvalid="this.setCustomValidity('Select Student branch')"
                                    oninput="setCustomValidity('')">
                                    <option value="">--Select--</option>
                                    <option value="Computer Science">Computer Science </option>
                                    <option value="Electronics">Electronics</option>
                                    <option value="Eletrical">Eletrical</option>
                                    <option value="Mechanical">Mechanical</option>
                                    <option value="Marine">Marine</option>
                                    <option value="Automobile">Automobile</option>
                                    <option value="Information Science">Information Science</option>
                                    <option value="Aeronautical">Aeronautical</option>
                                </select>
                            </div>
                            <div class="form-group mx-2">
                                <label for="inputaddress"><b>Semister</b></label>

                                <select class="form-control" id="sem" name="sem" required
                                    oninvalid="this.setCustomValidity('Select Student Semister')"
                                    oninput="setCustomValidity('')">
                                    <option value="">--Select--</option>
                                    <option value="1">1 </option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                </select>
                            </div><br>
                            <div class="form-group mx-2">
                                <label for="inputaddress"><b>Image</b></label>

                                <input type="file" class="form-control-file" id="images" name="images"
                                    aria-describedby="fileHelpBlock" accept=".png,.jpeg,.webp,.jpg" required>
                                <small id="fileHelpBlock" class="form-text text-muted">
                                    (ex .png,.jpeg,.webp )
                                </small>


                            </div>
                        </div>
                    </div>



                    <!-- <div class="form-group mx-2">
                       

                    </div>
                    <div class="form-group mx-2">
                       
                    </div> -->
                </div>
                <div class="modal-footer my-3">
                    <button type="button" class="btn btn-secondary btn-lg" data-dismiss="modal">Close</button>
                    <button class="btn text-white btn-lg" style="background-color:#8f02fa; width: 10%;" name="submit"
                        type="submit">Save</button>
                </div>
            </div>
        </div>
    </div>
</form>

<!-- Upload Excel Modal -->
<div class="modal fade" id="uploadExcelModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Import Student Data</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <form action="/importstudents/" method="POST" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="file" accept=".xlsx,.xls,.csv" name="file" class="form-control mb-3" required />
                <button type="submit" class="btn btn-primary">Upload</button>
            </form>
        </div>
      </div>
    </div>
  </div>

<form class="container mt-5">
    <div class="card bg-light ">

        <div class="card-body">
            <div class="">
                <a class="btn  text-white mb-2" style="background-color: #8f02fa" data-toggle="modal"
                    data-target="#Doctor">Add Student</a>
                    <a class="btn text-white mb-2 ml-1" style="background-color: #018216" data-toggle="modal" data-target="#uploadExcelModal">Import Excel</a>
            </div>

            <div class="form-group">
                <table class="table  table-striped table-hover ">
                    <thead>
                        <tr>
                            <th scope=col>#</th>
                            <th scope=col>Image</th>
                            <th scope=col>Name</th>
                            <th scope=col>Age</th>
                            <th scope=col>Phone Number</th>

                            <th scope=col>Email</th>
                            <!-- <th scope=col>Address</th> -->
                            <th scope=col>Gender</th>
                            <th scope=col>Status</th>
                            <th scope=col>Action</th>
                            <th scope=col></th>
                        </tr>
                    </thead>




                    <tbody>

                        {% if not Student%}
                        <tr>
                            <td colspan="8" class="text-center text-danger">
                                No Record Found
                            </td>
                        </tr>

                        {%else%}
                        {% for student in Student %}

                        <tr>
                            <td>{{forloop.counter}}</td>
                            <td>
                                <img src="/media/Student/{{student.Image}}" width="50" height="50">
                            </td>
                            <!-- <td> <img src="/PlayersImage/Player-7032391352.jpg"></td> -->

                            <td>{{student.name}}</td>
                            <td>{{student.age}}</td>

                            <td>{{student.contact}}</td>
                            <td>{{student.email}}</td>
                            <!-- <td>{{student.address}}</td> -->
                            <td>{{student.gender}}</td>
                            <td>{%if student.is_enabled %}
                                <span style="color:#36b028;text-align:center;">Active</span>

                                {%else%}
                                <span style="color:#fc0313;text-align:center;">Deactive</span>

                                {% endif %}
                            </td>
                            <td>{%if student.is_enabled %}
                                <p> <button type="button" id="button" onclick="change('{{student.id}}','0');"
                                        value="{{student.id}}" class="btn btn-danger">Disable</button></p>

                                {%else%}
                                <p> <button type="button" id="button" onclick="change('{{student.id}}','1');"
                                        value="{{student.id}}" class="btn btn-success">Enable</button></p>


                                {% endif %}
                            </td>
                            <td><a class="form-group mt-2" onclick="update('{{student.id}}');" href="#">More..</a></td>
                        </tr>
                    </tbody>
                    {% endfor %}
                    {% endif %}
                </table>
            </div>
        </div>
    </div>

</form>

<!-- --------Modal--------- -->

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header ">
                <div class="container">
                    <div class="text-center mt-3">
                        <strong>
                            <h3><b><p id="Name"></p></b></h3>
                        </strong><br>
                    </div>
                </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="modal-group">
                <div class="modal-group">
                    
                    <div class="row">
                        <div class="col-md-4 mt-1 ml-2">
                            <!-- <div class="mt-5"></div> -->
    
                            <img alt="" style="width:600px;" title="" id="my_image" class="img-circle img-thumbnail isTooltip"
                                src="" data-original-title="Usuario">
    
                            <!-- <div class="container text-center mt-4 ">
                                <button type="button" id="Update" onclick="update('{{student.id}}');" value="{{student.id}}"
                                    class="btn btn-warning w-25 ">Edit
                            </div> -->
                        </div>
    
    
                        <div class="col-md-7">
    
    
                            <div class="table-responsive">
                                <table class="table table-user-information">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-asterisk text-primary"></span>
                                                    USN
                                                </strong>
                                            </td>
                                            <td class="text-primary" >
                                                <span class="username"></span>
                                                <!-- <p id="username"></p> -->
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-user  text-primary"></span>
                                                    Phone Number
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span class="phone"></span>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-cloud text-primary"></span>
                                                    Email
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span class="email"></span>
                                            </td>
                                        </tr>
    
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-bookmark text-primary"></span>
                                                    Age
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span class="age"></span>
                                            </td>
                                        </tr>
    
    
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-eye-open text-primary"></span>
                                                    Gender
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span class="gender"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-envelope text-primary"></span>
                                                    Father Name
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span class="fathername"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-calendar text-primary"></span>
                                                    Address
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span class="address"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-calendar text-primary"></span>
                                                    Branch
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span class="branch"></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-calendar text-primary"></span>
                                                    Semister
                                                </strong>
                                            </td>
                                            <td class="text-primary">
                                                <span class="sem"></span>
                                                Semister
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-calendar text-primary"></span>
                                                    Year
                                                </strong>
                                            </td>
                                            <td class="text-primary" >
                                                <span class="year"></span>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <strong>
                                                    <span class="glyphicon glyphicon-calendar text-primary"></span>
                                                    Status
                                                </strong>
                                            </td>
                                            <td class="text-primary" >
                                                <span style="color:#36b028;text-align:center;" id="active">Active</span>

                                            
                                                <span style="color:#fc0313;text-align:center;" id="deactive">Deactive</span>

                                            </td>
                                        </tr>
    
                                    </tbody>
                                </table>
                            </div>
                        </div>
    
                    </div>
                   
                </div>
            </div>
            
            
            
            </div>
        </div>
    </div>


    <script type="text/javascript">
        function change(id, data) {
            Swal.fire({
                title: 'Are you sure?',
                showDenyButton: true,
                showCancelButton: false,
                confirmButtonText: 'Yes',
                denyButtonText: 'No',
            }).then((result) => {
                if (result.isConfirmed) {
                    $.ajax({
                        type: "GET",
                        url: "/UpdateButton/",
                        data: {
                            Id: id,
                            flag: data
                        },
                        timeout: 10000,
                        success: function () {
                            window.location.href = "/StudentManage/";
                        }
                    });
                } else if (result.isDenied) {
                }
            })

        }

        function update(ID) {
            $.ajax({
                type: "GET",
                url: "/editAccount/",

                data: { id: ID },
                success: function (result) {

                    console.log(result[0].contact);
                    $('#Name').text(result[0].name);
                    $(".username").html(result[0].username);
                    $(".phone").html(result[0].contact);
                    $(".email").html(result[0].email);
                    $(".address").html(result[0].address);
                    $(".age").html(result[0].age);
                    $(".gender").html(result[0].gender);
                    $(".id").html(result[0].id);
                    $(".year").html(result[0].year);
                    $(".fathername").html(result[0].fatherName);
                    $(".branch").html(result[0].branch);
                    $(".sem").html(result[0].Semister);
                    $("#my_image").attr("src", '/media/Student/' + result[0].Image);
                    
                    if(result[0].is_enabled ==1){
                        $('#active').show();
                        $('#deactive').hide();
                    }else{
                        $('#active').hide();
                        $('#deactive').show();
                    }

                    // $("#images").attr(result[0].Image);
                    // $("#img").val(result[0].Image);

                    $("#exampleModal").modal("show");
                    // $('#data').show();
                    // console.log(result[0]);
                    return;
                },
            });
        }




    </script>
    {% endblock %}